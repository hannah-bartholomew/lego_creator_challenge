create schema HANNAH_SCHEMA;

use schema til_portfolio_projects.hannah_schema;

CREATE TABLE HANNAH_SCHEMA.COLORS (
ID INTEGER,
Name VARCHAR(28),
RGB VARCHAR(6),
IS_TRANS VARCHAR(1)
);

CREATE OR REPLACE TABLE HANNAH_SCHEMA.INVENTORIES (
ID INTEGER,
VERSION INTEGER,
SET_NUM VARCHAR(50)
);

CREATE TABLE HANNAH_SCHEMA.INVENTORY_PARTS (
INVENTORY_ID INTEGER,
PART_NUM VARCHAR(50),
COLOR_ID INTEGER,
QUANTITY INTEGER,
IS_SPARE VARCHAR(50)
);

CREATE TABLE HANNAH_SCHEMA.INVENTORY_SETS (
INVENTORY_ID INTEGER,
SET_NUM VARCHAR(50),
QUANTITY INTEGER
);

CREATE OR REPLACE TABLE HANNAH_SCHEMA.PARTS (
PART_NUM VARCHAR(50),
NAME VARCHAR(255),
PART_CAT_ID INTEGER
);

CREATE TABLE HANNAH_SCHEMA.PART_CATEGORIES (
ID INTEGER,
NAME VARCHAR(50)
);

CREATE OR REPLACE TABLE HANNAH_SCHEMA.SETS(
SET_NUM VARCHAR(50),
NAME VARCHAR(255),
YEAR INTEGER,
THEME_ID INTEGER,
NUM_PARTS INTEGER
);

CREATE TABLE HANNAH_SCHEMA.THEMES(
ID INTEGER,
NAME VARCHAR(50),
PARENT_ID INTEGER
);

INSERT INTO HANNAH_SCHEMA.COLORS (
SELECT *
FROM  STAGING.LEGO_COLORS
);

INSERT INTO HANNAH_SCHEMA.INVENTORIES (
SELECT *
FROM  STAGING.LEGO_INVENTORIES
);

INSERT INTO HANNAH_SCHEMA.INVENTORY_PARTS (
SELECT *
FROM  STAGING.LEGO_INVENTORY_PARTS
);

INSERT INTO HANNAH_SCHEMA.INVENTORY_SETS (
SELECT *
FROM  STAGING.LEGO_INVENTORY_SETS
);

INSERT INTO HANNAH_SCHEMA.PARTS (
SELECT *
FROM  STAGING.LEGO_PARTS
);

INSERT INTO HANNAH_SCHEMA.PART_CATEGORIES (
SELECT *
FROM  STAGING.LEGO_PART_CATEGORIES
);

INSERT INTO HANNAH_SCHEMA.SETS (
SELECT *
FROM  STAGING.LEGO_SETS
);

INSERT INTO HANNAH_SCHEMA.THEMES (
SELECT *
FROM  STAGING.LEGO_THEMES
);

-- --Set a primary key:
ALTER TABLE COLORS ADD PRIMARY KEY (ID);
ALTER TABLE INVENTORIES ADD PRIMARY KEY (ID);
ALTER TABLE PARTS ADD PRIMARY KEY (PART_NUM);
ALTER TABLE PART_CATEGORIES ADD PRIMARY KEY (ID);
ALTER TABLE SETS ADD PRIMARY KEY (SET_NUM);
ALTER TABLE THEMES ADD PRIMARY KEY (ID);

--Set a foreign key:
ALTER TABLE INVENTORIES ADD FOREIGN KEY (SET_NUM) REFERENCES SETS(SET_NUM);
ALTER TABLE INVENTORY_PARTS ADD FOREIGN KEY (INVENTORY_ID) REFERENCES INVENTORIES(ID);
ALTER TABLE INVENTORY_PARTS ADD FOREIGN KEY (PART_NUM) REFERENCES PARTS(PART_NUM);
ALTER TABLE INVENTORY_PARTS ADD FOREIGN KEY (COLOR_ID) REFERENCES COLORS(ID);
ALTER TABLE INVENTORY_SETS ADD FOREIGN KEY (SET_NUM) REFERENCES SETS(SET_NUM);
ALTER TABLE INVENTORY_SETS ADD FOREIGN KEY (INVENTORY_ID) REFERENCES INVENTORIES(ID);
ALTER TABLE PARTS ADD FOREIGN KEY (PART_CAT_ID) REFERENCES PART_CATEGORIES(ID);
ALTER TABLE SETS ADD FOREIGN KEY (THEME_ID) REFERENCES THEMES(ID)
